---
sidebarDepth: 0
title: はじめに
---

## 著作権表示
FreeNAS® is © 2011-2019 iXsystems

FreeNAS® and the FreeNAS® logo are registered trademarks of iXsystems

FreeBSD® is a registered trademark of the FreeBSD Foundation

Written by users of the FreeNAS® network-attached storage operating system.

Version 11.2

Copyright © 2011-2019 iXsystems

This Guide covers the installation and use of FreeNAS® 11.2.

The FreeNAS® User Guide is a work in progress and relies on the contributions of many individuals. If you are interested in helping us to improve the Guide, read the instructions in the README. IRC Freenode users are welcome to join the #freenas channel where you will find other FreeNAS® users.

The FreeNAS® User Guide is freely available for sharing and redistribution under the terms of the Creative Commons Attribution License. This means that you have permission to copy, distribute, translate, and adapt the work as long as you attribute iXsystems as the original source of the Guide.

FreeNAS® and the FreeNAS® logo are registered trademarks of iXsystems.

Active Directory® is a registered trademark or trademark of Microsoft Corporation in the United States and/or other countries.

Apple, Mac and Mac OS are trademarks of Apple Inc., registered in the U.S. and other countries.

Broadcom is a trademark of Broadcom Corporation.

Chelsio® is a registered trademark of Chelsio Communications.

Cisco® is a registered trademark or trademark of Cisco Systems, Inc. and/or its affiliates in the United States and certain other countries.

Django® is a registered trademark of Django Software Foundation.

Facebook® is a registered trademark of Facebook Inc.

FreeBSD® and the FreeBSD® logo are registered trademarks of the FreeBSD Foundation®.

Intel, the Intel logo, Pentium Inside, and Pentium are trademarks of Intel Corporation in the U.S. and/or other countries.

LinkedIn® is a registered trademark of LinkedIn Corporation.

Linux® is a registered trademark of Linus Torvalds.

Oracle is a registered trademark of Oracle Corporation and/or its affiliates.

Twitter is a trademark of Twitter, Inc. in the United States and other countries.

UNIX® is a registered trademark of The Open Group.

VirtualBox® is a registered trademark of Oracle.

VMware® is a registered trademark of VMware, Inc.

Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc., a non-profit organization.

Windows® is a registered trademark of Microsoft Corporation in the United States and other countries.

#### 表記規約

FreeNASの® 11.2ユーザガイドには、これらの表記規則を使用しています。

| 項目 | 視覚的な例 |
|--------------------------------------------------------------------|---------------------------------------------|
| グラフィック要素：ボタン、アイコン、フィールド、列、およびボックス | [ Import CA ]ボタンをクリックします。 |
| メニュー選択 | システム‣情報を選択します。 |
| コマンド | scpコマンドを使用してください。 |
| ファイル名とプールとデータセットの名前 | /etc/rc.confファイルを見つけます。 |
| キーボードキー | 押しEnterキーを。 |
| 重要なポイント | これは重要。 |
| フィールドに入力された値、またはデバイス名 | アドレスフィールドに127.0.0.1と入力します。 |

表1 テキストフォーマットの例

| アイコン | 使用法 |
|---------------------------|--------------------------------------------|
| 追加 | 新しいアイテムを追加してください。 |
| Settings（設定） | 設定メニューを表示します。 |
| Options（オプション） | オプションメニューを表示します。 |
| Browse（参照） | システムディレクトリの拡大図を表示します。 |
| Power（電源） | 電源オプションメニューを表示します。 |
| Show（表示） | パスワードフィールドの文字を表示します。 |
| Hide（隠す） | パスワードフィールドの文字を隠します。 |
| Configure（設定） | 編集の設定。 |
| 襁（打ち上げ） | サービスを起動します。 |
| ▶（スタート） | 刑務所を始めなさい。 |
| Stop（停止） | 刑務所をやめなさい。 |
| Update（更新） | 刑務所を更新します。 |
| Delete（削除） | 刑務所を削除します。 |
| Encry（暗号化オプション） | プールの暗号化オプション |

表2 FreNASのアイコン

 # はじめに

FreeNASのは®埋め込まれたオープンソースのネットワーク接続ストレージ（NAS）オペレーティング・システムのFreeBSDに基づいており、下に放出される 、2句のBSDライセンス。NASには、ファイルの保存と共有に最適化されたオペレーティングシステムがあります。

FreeNASの®は、ブラウザベースのグラフィカル構成インターフェースを提供します。内蔵のネットワークプロトコルは、複数のオペレーティングシステムへのストレージアクセスを提供します。追加のソフトウェアをインストールすることによって組み込み機能を拡張するためのプラグインシステムが提供されています。

## 11.2の新機能
FreeNASの® 11.2は、オペレーティングシステム、ベースアプリケーション、およびドライバにいくつかの新しい重要な機能、既存の機能に多くの改良とバグの修正、およびバージョンの更新が含ま機能リリース、です。ユーザはこれらの改良とバグ修正を利用するためにこのリリースにアップデートすることをお勧めします。

これらの主な機能は、このバージョンの新機能です。

- ログイン画面はデフォルトで新しいAngularベースのUIになります。従来のUIを使い続けたいユーザーは、ログイン画面で「Legacy UI」を選択できます。
- このリリース以降、新しいUI内のガイドの公開バージョン およびガイドオプションに表示されるスクリーンショット は、新しいUI用です。ただし、クラシックUIにログインしている間にガイドアイコンをクリックしたユーザーには、引き続き古いUIのスクリーンショットが表示されます。ガイドの両方のバージョンが利用可能になるのは、移行期間中にクラシックUIが将来のリリースで非推奨になる前に、新しいUIに慣れてきたユーザーを支援するためです。
- 古いAPIから新しいミドルウェアへの書き換えは続きます。書き換えが完了すると、api.freenas.org は推奨されなくなり、新しいAPIドキュメントに置き換えられます。その間に、新しいミドルウェアのAPIドキュメントを見るには、新しいUIにログインし、ブラウザのロケーションバーにあるFreeNASシステムのURLをクリックして、そのURL /api/docsの最後に追加します。
- ブートローダはGRUBからネイティブのFreeBSDブートローダに変更されました。これにより、一部のユーザーがGRUBで経験したいくつかの問題を解決するはずです。FreeBSDのブートローダがブート環境を完全にサポートするようになるまで、GRUBは一時的な解決策として導入されました。
- プラグインと刑務所のバックエンドから切り替わった 看守するiocageと監視員は、もはやバグ修正を受信しません。新しいUIは自動的に iocageを使ってプラグインとJailsを作成し管理します。サポートされている最新のアプリケーションバージョンを実行していることを確認するために、新しいUIを使用して既存のプラグインと Jailsを再作成することをお勧めします。
- プラグインはFreeBSD 11.2-RELEASEに切り替えられ、すべてのプラグインはこのバージョン用に再構築されました。
- 仮想マシンはよりクラッシュ耐性があります。ゲストが起動されると、利用可能なメモリ容量がチェックされ、システムリソースが不十分な場合は初期化エラーが発生します。起動時にゲストにメモリをオーバーコミットするオプションがありますが、これは通常の使用にはお勧めできません。ゲストが停止すると、そのリソースがシステムに返されます。さらに、UEFIブートメニューの修正により、Linuxカーネル4.15以降を正しく起動できるようになりました。
- クラウド同期タスクは、データが送信される前に暗号化し、クラウド上に保存されている間は暗号化された形式でデータを保持するための設定オプションを提供します。ファイル名は暗号化することもできます。
- 自己暗号化ドライブ （SED）の予備サポートが追加されました。

このソフトウェアは追加または更新されました。

- 基本オペレーティングシステムはFreeBSD 11.2の STABLEブランチです 。これは多くの更新されたドライバとバグ修正をもたらします。このブランチは、FreeBSD-SA-18：13.nfsまでのFreeBSDセキュリティ勧告を含むようにパッチが当てられてい ます。
- Linux上のZFSから移植されたソート済みスクラブのサポートのおかげで、OpenZFSはIllumosで最新かつ少し先を進んでいます。注目に値する改善には、チャンネルプログラム、データディスクの削除、より弾力的なボリュームのインポート、vdevが欠けているプールをインポートする機能、プールのチェックポイント、圧縮ARCのパフォーマンスの向上、およびZILのバッチ処理が含まれます。この変更の一環として、デフォルトのZFS間接ブロックサイズが128 KiBから32 KiBに縮小されました。これらの改善点の多くはさらなるテストが必要なのでまだUIに統合されていないことに注意してください。
- IPsecカーネルモジュールが追加されました。kldload ipsecを使って手動でロードできます 。
- eMMCフラッシュストレージのサポートが追加されました。
- EM、 IGB、 のixgbe、およびIXL インテルのドライバがMTUに設定されたときに発生するパフォーマンス低下の問題を解決するパッチが適用されている9000（9Kジャンボクラスタ）。以下のため9Kジャンボクラスタを構成する前に cxgbe 作成の調整パラメータをして 変数のhw.cxgbe.largest_rx_cluster、タイプのローダー、および値の4096。 cxgbの ドライバは、ジャンボクラスタをサポートしていませんし、より大きなMTU使用しないでください4096。
- bnxtドライバは、BroadcomのNetXtreme-CとのNetXtreme-Eイーサネットドライバのサポートを提供する追加されています。
- VT端末は デフォルトで使用されているとはsyscons端子がカーネルから削除されます。
- 基本システムにncduが追加されました。このCLIユーティリティは、コンソールまたはSSHセッションからディスク使用量を分析するために使用できます。
- drm-next-kmod が基本システムに追加され、Intelグラフィックカード用のコンソールにUTF-8フォントのサポートが追加されました。
- Samba 4.7は最新のセキュリティ脆弱性に対処するために修正されている 。
- rsyncがバージョン3.1.3にアップデートされました 。
- rcloneがバージョン1.44にアップデートされました 。
- Minioがバージョン2018-04-04T05にアップデートされ ました。
- Netdataはバージョン1.10.0にアップデートされ ました。
- iocageは10月3日の時点でアップストリームと同期され、多くのバグ修正とIPv6サポートの改善を提供しています。
- RancherOSがバージョン1.4.2にアップデートされました 。
- zshは新規インストール用のルートシェルです。アップグレードでは、引き続きデフォルトのrootシェルとしてcshシェルが使用されます。
- ifconfigのタップインターフェイスの説明に、接続されている仮想マシンの名前が表示されるようになりました。
- xattrは基本システムに追加されており、コマンド行からファイル拡張属性を変更するために使用できます。利用可能なオプションを表示するには、xattr -hと入力します。
- convmvが基本システムに追加され、コマンドラインからファイル名のエンコーディングを変換するために使用することができます。利用可能なオプションを表示するには、convmvと入力します。
- cloneacl CLIユーティリティが追加されました。複雑なACLを既存の共有に再帰的に複製するために使用することができます。使用方法についてはcloneaclと入力してください。
- これらのスイッチは、freenas-debug： -MSATADOM情報のダンプと-Z古いデバッグ情報の削除のために追加されました。-GシステムはもはやGRUBを使用してスイッチが削除されていません。-Jスイッチが削除され、-jスイッチではなく、ウォーデンのiocage刑務所の情報を表示するように書き直されました。
- これらのスイッチがarcstatに追加されました。使用可能なすべての統計を表示するための-aと、接尾辞なしで生数値を表示するための-p。

これらの画面オプションは変更されました。


- ATAセキュリティユーザー、SEDパスワード、および SEDパスワードリセットフィールドが追加されました システム‣高度な。
- [ コンソールのスクリーンセーバーを有効にする]フィールドは、システム‣詳細設定から削除されました 。
- カーネルのクラッシュダンプ、毎日のテレメトリの有効自動アップロードのチェックボックスから削除されている システム‣高度な。
- [ 省電力デーモンを有効にする ]オプションは、システム‣詳細設定から削除されました。
- [アラート設定]が[ システム]に追加され、利用可能なアラート条件を一覧表示したり、アラートごとに通知頻度を設定したりするために使用できます。
- これらのクラウド認証情報がシステムに追加されました ‣クラウド認証情報：Amazonクラウドドライブ、ボックス、ドロップボックス、FTP、Googleドライブ、HTTP、Hubic、Mega、Microsoft OneDrive、pCloud、SFTP、WebDAV、およびYandex。
- [ チームドライブID]フィールドが[ システム]‣クラウド認証情報‣[追加]に追加され 、Googleドライブがプロバイダーの場合に表示されます。
- エンドポイントのURLはに追加された システム- >クラウド資格情報は- >クラウド資格を追加します が、場合にのみ表示されますアマゾンS3がとして選択されている プロバイダ。これは、Wasabiなどの他のS3互換サービスへの接続を設定するために使用できます。
- ドライブアカウントタイプとドライブID がシステム - >クラウド認証情報 - >クラウド認証情報の追加に追加されました 。これらのフィールドは、Microsoft OneDriveがプロバイダーとして選択されている場合に表示され ます。
- [ システム]‣ [ アップデート ]の[ 新しいアップデートを自動的にチェックする ]オプションが、[ 毎日アップデートをチェックする ]と[ 利用可能な場合はダウンロードする ]に 変更されました 。
- システム‣Updateの列車セレクタ が変更され、ドロップダウンメニューに許容列車のみが表示されるようになりました。各列車のオプションには詳細な説明があります。
- システムアップグレードを実行する前に、システム設定のコピーを保存し、パスワードシークレットシードを含めるように求めるプロンプトを追加するオプションがあります。このポップアップは（設定）‣設定に進み、 アップグレード前に「設定を保存」ダイアログを有効にするの設定を解除することで有効にできます。
- [ コンテナ]、[ リモート暗号化]、[ ファイル名暗号化]、[ 暗号化パスワード]、および[ 暗号化ソルト]フィールドが[タスク]> [クラウド同期]タスク> [クラウド同期の追加]に追加されました 。
- 最初のインターフェースを設定するときに、ネットワーク‣インターフェース‣インターフェースの追加のNICおよびインターフェース名フィールドは 、WebインターフェースのNIC設定で事前設定されています。ユーザがWebインターフェイスNICの前に別のインターフェイスを設定しようとすると、警告が表示されます。
- Storage‣Pools‣Zvolの追加‣ADVANCED MODEのBlock sizeフィールドでは 、4Kより小さいサイズを選択できなくなりました。これは、パフォーマンス上の問題が、効率的な処理には小さすぎるブロックサイズを設定するのを防ぐためです。
- Execのフィールドが追加されました ストレージプール‣‣データセット‣ADVANCED MODEを追加します。レコードサイズのフィールドは、もはやよりもサイズが小さく選ぶことができますない4K。これは、パフォーマンス上の問題が、効率的な処理には小さすぎるブロックサイズを設定するのを防ぐためです。
- [ 作成日 ]列が[ ストレージ]‣スナップショットに追加されました 。
- 「SEDのパスワード」列が「ストレージ」‣ディスクに追加されました 。
- [ ストレージ ]> [ ディスクのインポート ]に[ MSDOSFSロケール ]ドロップダウンメニューが追加されました 。
- ドメインアカウントのパスワードで ディレクトリサービス‣Active Directoryは 、初めてのドメインを設定する際にのみ必要です。
- 「ユーザーベース」および「グループベース」フィールドは、ディレクトリサービス‣Active Directory‣詳細モードから削除されました 。
- [ ホームディレクトリを有効にする]、[ ホームディレクトリ]、[ ホーム共有名]、および[ ホーム共有タイムマシン] フィールドは[ サービス]‣AFPから削除され、[ タイムマシン割り当て]フィールドは[ 共有]‣アップル（AFP）共有から削除されました 。これらのフィールドは、共有‣Apple（AFP）共有‣ホームシェアとして使用するに置き換えられました 。
- Services‣TFTPのUmaskフィールドがFile Permissionsセレクタに変更されました。
- [ ホスト名]フィールドが[ サービス]‣UPSに追加されました 。UPS Driver with が選択されている場合、このフィールドはPortフィールドを置き換え ます。snmp
- BitTorrent SyncプラグインはResilio Syncに改名されました。
- ディスク温度グラフがReporting‣ディスクに追加されました 。このカテゴリは、グラフが表示される前にユーザーがデバイスとメトリックを選択できるように改良されました。
- 稼働時間グラフは、レポーティング‣システムタブから削除されました 。
- 仮想マシン‣デバイス追加および編集フォームには、VMデバイスの起動優先順位を設定するためのDevice Orderフィールドがあります。

### 1.1.1. リリース-U1
NetatalkはCVE-2018-1160に対応するために3.1.12にアップデートされました。

### 1.1.2. U2
- 基本オペレーティングシステムは、これらのセキュリティ勧告に対処するために修正されています。
    - ZFS vnode再利用デッドロック
    - bhyve（8）デバイスモデルの境界チェックが不十分
    - SQLiteアップデート
    - タイムゾーンデータベース情報の更新
    - kqueueの競合状態とカーネルパニック
    - システムコールカーネルデータレジスタリーク
- Inflaniband ドライバのMellanox ConnectX-4ファミリ用のmlx5ib（4）ドライバが追加されました。
- Sambaは4.9.4に更新されており 、これは新しい機能を受けている現在の安定版リリースです。このバージョンバンプにより、Time Machineのサポートが改善されただけでなく、パフォーマンスも大幅に向上しました。
- OpenSSLは CVE-2018-5407に対応するために1.0.2qにアップデートされ ました。
- セキュリティの脆弱性に対処するため、curlが7.62.0に更新され ました。
- ダッシュボードのプールウィジェット は現在のプールステータスを反映するように色が変わります。
- ヘルプテキストは画面に固定され、カーソルがヘルプアイコンから移動しても表示されたままになります。
- Amazon S3がプロバイダとして選択されている 場合、システム‣クラウド認証情報‣クラウド認証情報を追加にエンドポイントリージョンを無効にしてシグネチャバージョン2を 使用のチェックボックスが追加さ れました。
- アップデート後に再起動チェックボックスが追加されました システム‣更新‣手動更新
- Tasks（参照）オプションは、タスク‣クラウド同期タスク ‣ADDのフォルダーフィールド と共に表示されます。これにより、接続されている資格情報 リモートファイルシステムを参照できます。
- データセットスナップショットのロールバックは、ストレージ‣スナップショットでサポートされてい ます。
- ixnas VFSモジュールが追加されており、 aio_pthread VFSモジュールから削除された 共有‣のWindows（SMB）‣VFSオブジェクト。
- Time Machineのフィールドが追加されました 共有‣のWindows（SMB）株式‣ます。
- NAAの列が追加されました 共有‣ブロック（iSCSIの）‣エクステント。
- 有効SMB1サポートチェックボックスが追加されました サービス‣SMB。
- ADVANCEDプラグインインストールオプションが追加されました インストール‣使用可能なプラグイン‣。これにより、プラグインをインストールする前にプラグインを完全にカスタマイズすることができます。
- allow_mlock、vnet_interfaces、 hostid_strict_check、およびallow_tunフィールドが追加されました 刑務所‣‣高度な刑務所の作成追加 と 刑務所‣編集 フォームを。
- ReportingのARC Sizeグラフに 、圧縮された物理L2ARCサイズが表示されるようになりました。
- このopenipmiパッケージは、 usr/local/lib/collectd/ipmi.so機能しない収集されたIPMIプラグインを無効にするために削除されました。
- 起動するのを待つのフィールドを 編集‣仮想マシン‣デバイス‣VNCデバイス に名前が変更されましたVNC接続するまでの遅延VMを起動。
- アラート用 のsyslog-ngの 停止はに追加された システム‣警告設定。

## 1.2 パスと名前の長さ
ファイル、ディレクトリ、およびデバイスの名前は、FreeBSDオペレーティングシステムによって課されるいくつかの制限を受けます。ここに示されている制限は、それぞれが1バイトのスペースを占めるプレーンテキスト文字を使用した名前に対するものです。UTF-8文字の中には1バイト以上のスペースを取るものがあり、それらの文字を使用すると比例してこれらの制限が緩和されます。システムオーバーヘッドもこれらの制限の長さを1バイト以上減らすことができます。

| タイプ | 最大長 | 説明 |
|---|---| --- |
| ファイルパス | 1024バイト | 合計ファイルパス長（PATH_MAX）フルパスには、ディレクトリ区切り文字のスラッシュ文字、サブディレクトリ名、およびファイル自体の名前が含まれます。たとえば、パス /mnt/tank/mydataset/mydirectory/myfile.txtは42バイトです。 <br><br> 非常に長いファイル名またはディレクトリ名を使用すると、問題が生じる可能性があります。長いディレクトリ名とファイル名を含む完全なパスは、1024バイトの制限を超えることがあり、ディレクトリ名またはファイル名が短くなるか、ファイルがより短い合計パス長のディレクトリに移動されるまで、そのファイルへの直接アクセスを妨げます。 |  |  |
| ファイル名とディレクトリ名 | 255バイト | 個々のディレクトリまたはファイル名の長さ（NAME_MAX） |
| マウントされたファイルシステムパス | 88バイト | マウントされたファイルシステムのパス長（MNAMELEN）パスが長いと、デバイスがマウントされなくなる可能性があります。 |
| デバイスファイルシステムパス | 63バイト | devfs（8）デバイスパス長（SPECNAMELEN）。パスが長いと、デバイスが作成されなくなる可能性があります。 |

::: tip
88バイトは88 ASCII文字に相当します。Unicodeを使用すると、文字数は異なります。
:::

::: warning
スナップショットのマウントパス長が88バイトを超えると、スナップショット内のデータは安全ですがアクセスできなくなります。スナップショットのマウントパス長が88バイトの制限を下回ると、データに再びアクセスできるようになります。
:::

88バイトの制限は、自動スナップショットマウントと手動スナップショットマウントにわずかに異なる方法で影響します。

- **自動マウント**：ユーザーがスナップショット内のファイルを表示または検索しようとするたびに、ZFSはスナップショットを一時的にマウントします。使用されるマウントポイントは、同じZFSデータセット内の隠しディレクトリにあり ます。たとえば、スナップショットはにマウントされています。このパスの長さが88バイトを超えると、スナップショットはZFSによって自動的にマウントされず、スナップショットの内容は表示または検索できなくなります。これは、スナップショットを含むZFSプールまたはデータセットの名前を短い名前（または ）に変更するか、またはスナップショット名の2番目の部分を短くすることによって解決できます（.zfs/snapshot/namemypool/dataset/snap1@snap2/mnt/mypool/dataset/.zfs/snapshot/snap2/mypooldatasetsnap2これにより、マウントされたパスの合計長が88バイトを超えないようにします。ZFSは、名前変更操作の一環として、必要なファイルシステムのアンマウントまたは再マウントを自動的に実行します。名前を変更すると、スナップショットデータは再び表示され検索可能になります。
- **手動マウント**：同じサンプルのスナップショットが、シェルからmount -t zfs mypool / dataset / snap1 @ snap2 / mnt / mymountpointを使用して手動でマウントされます。パス /mnt/mountpoint/は88バイトを超えてはいけません。スナップショット名の長さは関係ありません。手動マウントポイントの名前を変更するときは、マウントポイントの名前を変更する前に、そのマウントポイントにマウントされているオブジェクトをumountコマンドで手動でマウント解除する必要があります。後で再マウントすることができます。

::: tip
ZFSによって自動的にマウントできないスナップショットは、短いマウントポイントパスを使用してシェルから手動でマウントすることができます。これにより、Webインタフェースや「ファイル履歴」や「バージョン」などの機能からは自動的にアクセスできないスナップショットをマウントしてアクセスすることができます。
:::

## 1.3. ハードウェアの推奨
FreeNASの® 11.2は、FreeBSD 11.2に基づいており、中に見られるのと同じハードウェアサポートしている FreeBSDのハードウェア互換性リストを。サポートされているプロセッサはセクション2.1 amd64に記載されてい ます。FreeNASの®は、 64ビットプロセッサのためにのみ使用可能です。このアーキテクチャは、AMDではamd64、IntelではIntel 64と呼ばれています。

::: tip
FreeNASの® GPTパーティションからブートします。これは、システムBIOSがレガシBIOSファームウェアインタフェースまたはEFIを使用して起動できる必要があることを意味します。
:::

実際のハードウェア要件は、FreeNASのの使用に依存して変化®システム。このセクションではスターターのガイドラインをいくつか紹介します。 FreeNAS®ハードウェアのフォーラムは、 FreeNASのからのパフォーマンスのヒントがある®ユーザーを、特定の要件を満たすために最適なハードウェアに関する質問を投稿する場所です。 ハードウェアの推奨事項 はシステムコンポーネントの詳細な推奨事項を 提供し、 FreeNAS®クイックハードウェアガイドはさまざまな構成のためのコンポーネントの短いリストを提供します。 FreeNAS®システムの構築、焼き付け、およびテストには、 新しいハードウェアのテストに関する詳細な手順があります。

### 1.3.1. RAM
FreeNASのを最大限に活用するための最良の方法®システムは、できるだけ多くのRAMをインストールすることです。RAMが多いほど、ZFSのパフォーマンスは向上します。 FreeNAS®フォーラムは、 より多くのRAMを追加することによって得られることができますどのくらいのパフォーマンス上のユーザーからの事例証拠を提供しています。

RAMに関する一般的なガイドライン

- **最低8 GiBのRAMが必要です。**
- 追加機能には追加のRAMが必要で、大容量のストレージにはキャッシュ用のRAMがさらに必要です。やや誇張された古いガイドラインでは、ディスク容量1 TBあたり1 GBのRAMです。
- 多くのユーザーでActive Directoryを使用するには、winbindの内部キャッシュに2 GiBのRAMを追加します。
- iSCSIの場合、パフォーマンスがそれほど重要でない場合は最低16 GiBのRAM、パフォーマンスが重要な場合は最低32 GiBのRAMを取り付けます。
- 刑務所は非常にメモリ効率的ですが、それ以外の場合はZFSで使用可能であるはずのメモリを使用できます。システムが多数のjail、または少数のリソース集中型のjailを実行している場合は、1〜4ギガバイトのRAMを追加すると便利です。このメモリはホストによって共有され、jailによって使用されていないときはZFSに使用されます。
- 仮想マシンには、ここに記載されている量を超える追加のRAMが必要です。仮想マシンが使用しているメモリは、VMの実行中はホストで利用できず、上記の量には含まれません。たとえば、それぞれ1 GiBのRAMを必要とする2つのVMを実行するシステムでは、さらに2 GiBのRAMが必要です。
- FreeNASのをインストールするとき®ヘッドレスシステム上で、BIOSでビデオカード用の共有メモリの設定を無効にします。
- ZFS重複排除の場合、重複排除するストレージの1TB当たり少なくとも5GiBのRAMがシステムにあることを確認してください。

ハードウェアがサポートしている場合は、ECC RAMを取り付けます。より高価ではありますが、ECC RAMはZFSのエラー訂正特性が発揮される前にデータの実行中の破損を防ぎ、ZFSによって実行されるチェックサムとパリティ計算に一貫性を持たせるため、強くお勧めします。データが重要な場合は、ECC RAMを使用してください。この ケーススタディで は、メモリ破損に関連するリスクについて説明します。

FreeNASのは使用しないでください® RAMの少なくとも8ジブせずにデータを格納します。多くのユーザーは、FreeNASの期待®はちょうど低下したパフォーマンスで、より少ないメモリで機能します。肝心なのは、これらの最小値は多くのユーザーからのフィードバックに基づいているということです。インストールされたシステムが原因のFreeNASという情報が豊富でRAMの少なくとも8ジブを持っていないときフォーラムやIRCで助けのための要求は、時には無視され®は少ないメモリと正常に動作しない場合があります。

### 1.3.2. オペレーティングシステムデバイス

FreeNASの®オペレーティングシステムは、記憶ディスクから分離している少なくとも一つの装置にインストールされています。デバイスは、SSD、USBメモリースティック、またはDOM（Disk on Module）です。ハードドライブへのインストールは推奨されません。そのドライブはデータストレージに使用できないからです。

::: tip
インストールファイルをUSBメモリに書き込むには、2つの USBポートが必要で、それぞれにUSBデバイスが挿入されています。他のUSBスティックは、FreeNASのための目的地である一方、1本のUSBスティックは、インストーラが含まれています®インストールが。FreeNASのための正しいUSBデバイスを選択するように注意してください®のインストール。FreeNASの®は、インストーラが含まれている同じデバイス上にインストールすることはできません。インストールが完了したら、インストーラのUSBメモリを取り外します。また、新しいFreeNASのからブートするようにBIOSの設定を調整する必要があるかもしれない®ブートデバイス。
:::

FreeNASのターゲット・デバイスのタイプとサイズを決定する際に®が インストールされると、次の点に注意してください

- 絶対最小ベアサイズは8 GiBです。それは多くのスペースを提供しません。推奨される最小値は16ジブです。これにより、オペレーティングシステムとアップデートによって作成された複数のブート環境のためのスペースが確保されます。より多くのスペースがより多くのブート環境のためのスペースを提供し、32 GiB以上が優先されます。
- SSDは（ソリッドステートディスク）は、高速かつ信頼性の高い、非常に良いのFreeNAS作る®オペレーティングシステムデバイスを。彼らの1つの不利な点はそれらが記憶ディスクのために必要とされるかもしれないディスク接続を必要とするということです。
- 比較的大きいSSD（120または128 GiB）でさえブートデバイスとして役立ちます。未使用スペースが無駄になっているように見えるかもしれませんが、そのスペースは代わりにSSDによってウェアレベリングのために内部的に使用されます。これにより、SSDが長持ちし、信頼性が高まります。
- 独自のブート環境を追加することを計画している場合は、ブート環境あたり約1 GiBのストレージを割り当てます。不要になった古いブート環境を削除することを検討してください。ブート環境は、システム‣ブートを使用して作成および削除できます 。
- ZFSは、安価で製造が不十分なスティック上のエラーをすぐに明らかにするので、高品質の有名ブランドのUSBスティックを使用してください。
- 信頼性の高い起動ディスクを使用するには、2つの同一のデバイスを使用して、インストール中に両方を選択してください。これにより、ミラー化された起動デバイスが作成されます。

::: tip
FreeNASの現在のバージョンの®オペレーティング・システム・デバイスから直接実行します。FreeNASの初期のバージョン®は RAMから走ったが、それは年の場合されていません。
:::

### 1.3.3. 記憶ディスクとコントローラ
FreeBSDハードウェアリストのディスクセクションにはサポートされているディスクコントローラの一覧があります。さらに、3ware 6 Gbps RAIDコントローラのサポートが、3ware RAIDコントローラを管理するためのCLIユーティリティtw_cliとともに追加されました。

FreeNASの®は、ホットプラグ対応ドライブをサポートしています。この機能を使用するには、BIOSでAHCIを有効にする必要があります。

Broadcom MegaRAIDコントローラや3Ware twa対応コントローラなどのHBAを使用することで、信頼性の高いディスクアラートと故障したドライブの即時レポートを取得できます。

::: tip
Broadcom SAS HBAのファームウェアを最新バージョンにアップグレードすることをお勧めします。
:::

一部のHighpoint RAIDコントローラは、SMARTデータまたは他のディスク情報（ディスクのシリアル番号など）のパススルーをサポートしていません。これは、FreeNASのと別のディスクコントローラを使用するのが最善である®を。

::: tip
システムは 、いくつかのドライバでサポートされているDell PERC H330およびH730のようなコントローラカード用のmrsas（4）ドライバを優先するように設定されています 。お勧めしませんが、 ローダTunable：を削除するか、を0に設定することで、 mfi（4）ドライバを代わりに使用できます 。hw.mfi.mrsas_enableValue
:::

RAIDアレイに追加する前にディスクをテストするための提案は、この フォーラム投稿にあります。また、不良ブロックは、 FreeNASのと一緒にインストールされて®テストディスクについて。

予算内でディスクサブシステムの最適化が許可されている場合は、読み書きのニーズとRAIDの要件を考慮してください。

- 安定した連続しない書き込みのためには、シーク時間の短いディスクを使用してください。例としては、約1ドル/ GiBの10Kまたは15K SASドライブがあります。例示的な構成は、１．８ＴｉＢの使用可能スペースをもたらすＲＡＩＤ１０内の６個の６００ＧｉＢ １５Ｋ ＳＡＳドライブ、または２．４ＴｉＢの使用可能スペースをもたらすＲＡＩＤ１０内の８個の６００ＧｉＢ １５Ｋ ＳＡＳドライブである。

ZFSの場合、 ZFSストレージプール のディスク容量要件は、最低16 GiBのディスク容量を推奨します。FreeNASの®は、各ドライブ上のスワップ領域の2ジブを割り当てます。ZFSのスペース要件と組み合わせると、これは3 GiB未満のドライブをフォーマットすることは不可能であることを意味 します。3ギガバイトより大きく、推奨される最小容量より小さいドライブは使用可能ですが、割り当てをスワップするためにストレージスペースの大部分を失います。たとえば、4 GiBドライブはスワップ割り当て後に2 GiBの使用可能スペースしかありません。

ハードウェアを購入している新しいZFSユーザーは、 まずZFS Storage Pools Recommendationsを読む必要があります 。

単一のデバイスのように動作するディスクのグループであるZFS vdevは、さまざまなサイズのディスクを使用して作成できます。ただし、各ディスクで使用可能な容量は、グループ内の最小のディスクと同じ容量に制限されています。たとえば、1つの2 TiBディスクと2つの4 TiBディスクを持つvdevは、各ディスクで2 TiBのスペースしか使用できません。一般に、最適なスペース使用量とパフォーマンスを得るには、同じサイズのディスクを使用してください。

ZFSドライブのサイズおよびコストの比較スプレッドシートは、 ディスクの異なる量およびサイズにより提供される使用可能なスペースを比較するために利用可能です。

### 1.3.4. ネットワークインタフェース

FreeBSDハードウェアノートのEthernetセクションは、どのドライバが各ドライバによってサポートされているかを示しています。多くのインターフェイスがサポートされていますが、FreeNASのは®ユーザーは、インテルとチェルシオインターフェースから最高のパフォーマンスを見てきましたので、新しいNICを購入する際にこれらのブランドを検討してください。Realtekカードは、これらのチップセットとのインターフェイスが独自のプロセッサを提供していないため、CPU負荷の下ではパフォーマンスが低下することがよくあります。

少なくとも、GigEインターフェースをお勧めします。GigEインタフェースとスイッチは家庭用に手頃な価格ですが、最近のディスクは110 MiB / sのスループットを容易に飽和させることができます。ネットワークスループットを向上させるために、LACPタイプのリンクアグリゲーションを使用して複数のGigEカードを結合することができます 。イーサネットスイッチはLACPをサポートする必要があるため、より高価な管理対象スイッチが必要になります。

ネットワークパフォーマンスが要件であり、多額の費用がかかる場合は、10個のGigEインターフェイスと管理対象スイッチを使用してください。LACPとジャンボフレームをサポートするマネージドスイッチは、どちらもネットワークスループットを向上させるために使用できるため、推奨されます。詳細については10 Gig Networking Primer を参照してください 。

::: tip
現時点では、これらはサポートされていません：InfiniBand、FibreChannel over Ethernet、または無線インターフェイス。
:::

ハードウェアと共有の種類の両方がネットワークパフォーマンスに影響を与える可能性があります。Sambaはシングルスレッドであるため、同じハードウェア上でSMBはFTPまたはNFSより低速です 。そのため、高速のCPUはSMBのパフォーマンスに役立ちます。

Wake on LAN（WOL）サポートは、インタフェースのFreeBSDドライバに依存します。ドライバがWOLをサポートしている場合、ifconfig（8）を使って有効にすることができます 。WOLが特定のインターフェイスでサポートされているかどうかを判断するには、次のコマンドでインターフェイス名を使用します。この例では、capabilities行は、WOLがre0 インターフェイスでサポートされていることを示しています。

```
ifconfig -m re0
re0：flags = 8943 <UP、BROADCAST、RUNNING、PROMISC、SIMPLEX、MULTICAST>メトリック0 mtu 1500
        options = 42098 <VLAN_MTU、VLAN_HWTAGGING、VLAN_HWCSUM、WOL_MAGIC、VLAN_HWTSO>
        capabilities = 5399b <RXCSUM、TXCSUM、VLAN_MTU、VLAN_HWTAGGING、VLAN_HWCSUM、TSO4、WOL_UCAST、WOL_MCAST、WOL_MAGIC、VLAN_HWFILTER、VLAN_H WTSO>
```

WOLサポートが表示されていても特定のインターフェースで機能しない場合は、サポートの指示に従ってバグレポートを作成してください。

## 1.4 ZFSを使い始める
ZFSに不慣れな読者は、ZFS入門を読むのに少し時間がかかるはずです。